{#
    Admin Dashboard Base Template
    - Provides the main layout for admin functionality.
    - Includes sidebar navigation, top banner, filters, and content sections.
    - Dynamically loads dashboard, orders, products, inventory, and users sections.
    - Integrates with admin_base.js for section switching and filter logic.
    - Expects context variables and includes other templates for modularity.
#}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>{% block title %}Elite{% endblock %}</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles/admin_base.css') }}" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" />
    <!-- Main JS for admin dashboard logic -->
    <script src="{{ url_for('static', filename='java/admin_base.js') }}"></script>
</head>
<body>
    <!-- Hidden checkbox for super admin status (used by JS) -->
    <input type="checkbox" id="superstatus" {% if clearance == 3 %}checked{% endif %} style="display: none;">
    <div class="admin-container">
        <!-- Sidebar Navigation -->
        <div class="side">
            <img class="side-logo" src="{{ url_for('static', filename='images/elite-gold-logo.png') }}">
            <div class="side-menu">
                <!-- Sidebar menu items trigger section switching via JS -->
                <div class="side-menu-dashboard" onclick="section('Dashboard')">
                    <img src="{{ url_for('static', filename='images/dashboard.png') }}" width="24px" height="24px" alt="Logout Icon" style="margin-left: 10px">
                    <span style="margin-left: 15px">Dashboard</span>
                </div>
                <div class="side-menu-order" onclick="section('Orders'); ordersRequest()">
                    <img src="{{ url_for('static', filename='images/order.png') }}" width="24px" height="24px" alt="Logout Icon" style="margin-left: 10px">
                    <span style="margin-left: 15px">Orders</span>
                </div>
                <div class="side-menu-products" onclick="section('Products'); productsRequest()">
                    <img src="{{ url_for('static', filename='images/products.png') }}" width="24px" height="24px" alt="Logout Icon" style="margin-left: 10px">
                    <span style="margin-left: 15px">Products</span>
                </div>
                <div class="side-menu-inventory" onclick="section('Inventory'); inventoryRequest()">
                    <img src="{{ url_for('static', filename='images/inventory.png') }}" width="24px" height="24px" alt="Logout Icon" style="margin-left: 10px">
                    <span style="margin-left: 15px">Inventory</span>
                </div>
                <div class="side-menu-users" onclick="section('Users'); usersRequest()">
                    <img src="{{ url_for('static', filename='images/dashboard.png') }}" width="24px" height="24px" alt="Logout Icon" style="margin-left: 10px">
                    <span style="margin-left: 15px">Users</span>
                </div>
            </div>
            <!-- Logout button -->
            <div class="side-logout">
                <div class="logout-button">
                    <img src="{{ url_for('static', filename='images/logout.png') }}" width="16px" height="16px" alt="Logout Icon">
                    <span style="margin-left: 10px">Logout</span>
                </div>
            </div>
        </div>
        <!-- Top Banner and Filters -->
        <div class="top">
            <div class="top-banner">
                <p class="banner-name" id="campus-name">{{campus}}</p>
                <div class="banner-name" id="banner-name">
                    {{banner}}
                </div>
                <div class="banner-right">
                    <!-- Product search bar -->
                    <div class="banner-search" id="product-search-bar">
                        <input id="productSearchInput" type="text" placeholder="Search products...">
                        <button class="btn btn-outline-primary" type="button" id="productSearchGo">Go</button>
                        <ul class="search-result" id="product-search-result"></ul>
                    </div>
                    <!-- Profile dropdown or login link -->
                    {% if session.get('username') %}
                    <div class="dropdown ms-3">
                        <a class="d-flex align-items-center justify-content-center rounded-circle profile-bubble"
                           href="#" id="profileDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                            {{ session['username'][0]|upper }}
                        </a>
                        <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="profileDropdown">
                            <li>
                                <a class="dropdown-item" href="{{ url_for('account.account') }}">
                                    <i class="bi bi-person me-2"></i> Account
                                </a>
                            </li>
                            <li>
                                <a class="dropdown-item text-danger" href="{{ url_for('auth.logout') }}">
                                    <i class="bi bi-box-arrow-right me-2"></i> Logout
                                </a>
                            </li>
                        </ul>
                    </div>
                    {% else %}
                    <a href="/auth/login" class="d-flex align-items-center justify-content-center rounded-circle profile-bubble ms-3">
                        <i class="bi bi-person"></i>
                    </a>
                    {% endif %}
                </div>
            </div>
            <!-- Campus & Date Filter Section -->
            <div class="top-filter-order" id="filter-order">
                <p style="font-size: 20px; font-weight: 700">Campus & Date Filter.</p>
                <div class="top-filter-order-selection">
                    <div class="top-filter-order-selection-campus">
                        <br>
                        <label for="campus"></label>
                        <select id="campus" class="top-filter-order-selection-campus-drop">
                            <option value="All">All Campus</option>
                            <option value="1">Wellington</option>
                            <option value="2">Hamilton</option>
                            <option value="3">Auckland</option>
                        </select>
                    </div>
                    <div class="top-filter-order-selection-startdate">
                        <label for="startdate">Start Date</label>
                        <br>
                        <input type="date" id="startdate" name="date" class="date-picker">
                    </div>
                    <div class="top-filter-order-selection-enddate">
                        <label for="end-date">End Date</label>
                        <br>
                        <input type="date" id="enddate" name="end-date" class="date-picker">
                    </div>
                    <div>
                        <br>
                        <div class="top-filter-order-selection-submit" onclick="submitFilter()">
                            Submit
                        </div>
                    </div>
                </div>
            </div>
            <!-- Product Search and Campus Filter Section -->
            <div class="top-filter-search" id="filter-search">
                <div class="top-filter-search-first">

                    <label for="campus2"></label>
                    <select id="campus2" class="top-filter-search-first-list">
                        <option value="All">All Campus</option>
                        <option value="1">Auckland Campus</option>
                        <option value="2">Hamilton Campus</option>
                        <option value="3">Wellington Campus</option>
                    </select>
                </div>
                <div class="top-filter-search-second" id="secondFilter">
                    <div class="top-filter-search-second-filter">
                        <img src="{{ url_for('static', filename='images/filter.png') }}" width="10px" height="10px" alt="Settings Logo">
                    </div>
                    <div class="top-filter-search-second-product" onclick="addProduct()" id="addProduct">
                        Add Product
                    </div>
                </div>
            </div>
        </div>
        <!-- Main Content Sections -->
        <div class="content" id="content">
            <!-- Each section is loaded via template include for modularity -->
            <div class="section dashboard" data-id="Dashboard">
                {% include "dashboard.html" %}
            </div>
            <div class="section orders" data-id="Orders">
                {% include "orders.html" %}
            </div>
            <div class="section products" data-id="Products">
                {% include "products.html" %}
            </div>
            <div class="section inventory" data-id="Inventory">
                {% include "inventory.html" %}
            </div>
            <div class="section users" data-id="Users">
                {% include "users.html" %}
            </div>
        </div>
        <!-- Add Product/User Popup Section -->
        {% include "add.html" %}
    </div>
    <!-- Popup Overlay for Success/Error messages -->
    <div class="popup" id="popup" style="{% if request.args.get('success') %}display: flex;{% else %}display: none;{% endif %}">
        {% include "popup.html" %}
    </div>
    <!-- Bootstrap JS for dropdowns and UI -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
<script>
    section("{{banner}}");
    const endDate = new Date();
    const startDate = new Date();
    startDate.setDate(startDate.getDate() - 7);
    document.getElementById('startdate').value = startDate.toISOString().split('T')[0];
    document.getElementById('enddate').value = endDate.toISOString().split('T')[0];
    dashboardRequest();
</script>